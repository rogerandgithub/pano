/*! sti-pano 2015-12-25 */
function log(a){$("#title").text(a)}function speech(a){if(a!=0){var b="http://tts.baidu.com/text2audio?lan=zh&ie=UTF-8&text="+a,c="<audio style='display:none' src='"+b+"' autoplay='autoplay' ></audio>";$("html").append(c)}}function topPos(a){var b=0;if(a.offsetParent)do b+=a.offsetTop;while(a=a.offsetParent);return b}function leftPos(a){var b=0;if(a.offsetParent)do b+=a.offsetLeft;while(a=a.offsetParent);return b}function isAndroid(){return-1!=navigator.userAgent.indexOf("Android")}function isIpad(){return-1!=navigator.userAgent.indexOf("iPad")}function pad(a,b){return Array(b-(""+a).length+1).join(0)+a}function abs(a){return a>0?a:-a}function urlencode(a){return a=(a+"").toString(),encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function urldecode(a){return decodeURI(a)}function getInt(a){var b="";for(i in a)parseInt(a[i])>=0&&parseInt(a[i])<10&&(b+=a[i]);return b}function getFloat(a){var b="";for(i in a)(parseInt(a[i])>=0&&parseInt(a[i])<10||"."==a[i])&&(b+=a[i]);return b}function text_length(a){for(var b=0,c=0;c<a.length;c++)a.charAt(c)>"~"?b+=2:b++;return b}function v3(a,b,c){return new THREE.Vector3(a,b,c)}function f3(a,b,c){return new THREE.Face3(a,b,c)}function getBase64Image(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0,a.width,a.height);var d=b.toDataURL("image/png");return d}function Cross(a,b,c,d,e,f){return[b*f-c*e,c*d-a*f,a*e-b*d]}function checkMobile(){return/AppleWebKit.*Mobile/i.test(navigator.userAgent)||/Android/i.test(navigator.userAgent)||/BlackBerry/i.test(navigator.userAgent)||/IEMobile/i.test(navigator.userAgent)||/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/.test(navigator.userAgent)?/iPad/i.test(navigator.userAgent)?/MicroMessenger/i.test(navigator.userAgent)?3:2:/MicroMessenger/i.test(navigator.userAgent)?3:1:0}function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length*chrsz))}function b64_sha1(a){return binb2b64(core_sha1(str2binb(a),a.length*chrsz))}function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length*chrsz))}function hex_hmac_sha1(a,b){return binb2hex(core_hmac_sha1(a,b))}function b64_hmac_sha1(a,b){return binb2b64(core_hmac_sha1(a,b))}function str_hmac_sha1(a,b){return binb2str(core_hmac_sha1(a,b))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var c=Array(80),d=1732584193,e=-271733879,f=-1732584194,g=271733878,h=-1009589776,i=0;i<a.length;i+=16){for(var j=d,k=e,l=f,m=g,n=h,o=0;80>o;o++){16>o?c[o]=a[i+o]:c[o]=rol(c[o-3]^c[o-8]^c[o-14]^c[o-16],1);var p=safe_add(safe_add(rol(d,5),sha1_ft(o,e,f,g)),safe_add(safe_add(h,c[o]),sha1_kt(o)));h=g,g=f,f=rol(e,30),e=d,d=p}d=safe_add(d,j),e=safe_add(e,k),f=safe_add(f,l),g=safe_add(g,m),h=safe_add(h,n)}return Array(d,e,f,g,h)}function sha1_ft(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function sha1_kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function core_hmac_sha1(a,b){var c=str2binb(a);c.length>16&&(c=core_sha1(c,a.length*chrsz));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var g=core_sha1(d.concat(str2binb(b)),512+b.length*chrsz);return core_sha1(e.concat(g),672)}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function rol(a,b){return a<<b|a>>>32-b}function str2binb(a){for(var b=Array(),c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<24-d%32;return b}function binb2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>24-d%32&c);return b}function binb2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>8*(3-d%4)+4&15)+b.charAt(a[d>>2]>>8*(3-d%4)&15);return c}function binb2b64(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0;d<4*a.length;d+=3)for(var e=(a[d>>2]>>8*(3-d%4)&255)<<16|(a[d+1>>2]>>8*(3-(d+1)%4)&255)<<8|a[d+2>>2]>>8*(3-(d+2)%4)&255,f=0;4>f;f++)c+=8*d+6*f>32*a.length?b64pad:b.charAt(e>>6*(3-f)&63);return c}var bindClick=function(a,b,c,d){function e(a){a.originalEvent&&(a=a.originalEvent),g=a.touches&&a.touches[0].pageX||a.originalEvent.touches[0].pageX,h=a.touches&&a.touches[0].pageY||a.originalEvent.touches[0].pageY}function f(a){a.originalEvent&&(a=a.originalEvent);var c=a.changedTouches[0].pageX,d=a.changedTouches[0].pageY;c==g&&d==h&&b.call(this,a)}var g,h;c?(c.delegate(d,"touchstart",e),c.delegate(d,"touchend",f)):(a.on("touchstart",e),a.on("touchend",f))},_touches={},bindZoom=function(a,b){var c=leftPos(a[0]),d=topPos(a[0]);a.on("touchstart",function(a){a.preventDefault(),a.stopPropagation();var b=parseInt(a.clientX>=0?a.clientX:a.touches[0].clientX),c=parseInt(a.clientY>=0?a.clientY:a.touches[0].clientY);_touches.f1x=b,_touches.f1y=c,a.touches&&a.touches.length>1&&(_touches.f2x=a.touches[1].pageX,_touches.f2y=a.touches[1].pageY),_touches.onTouching=!0}),a.on("touchend",function(a){a.preventDefault(),a.stopPropagation(),_touches.onTouching=!1}),a.on("touchmove",function(a){a.preventDefault(),a.stopPropagation();var e=parseInt(a.clientX>=0?a.clientX:a.touches[0].pageX),f=parseInt(a.clientY>=0?a.clientY:a.touches[0].pageY);if(e-=c,f-=d,!_touches.onTouching)return!1;if(a.touches&&a.touches.length>1){var g=e,h=f,i=a.touches[1].pageX,j=a.touches[1].pageY,k=distance2D(_touches.f1x,_touches.f1y,_touches.f2x,_touches.f2y)-distance2D(g,h,i,j),l=.12;return b(k*l),_touches.f1x=g,_touches.f1y=h,_touches.f2x=i,_touches.f2y=j,!1}})},dateformat=function(a,b){var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},PI=3.1415926,unicode2Chr=function(a){if(""!=a){var b,c,d;for(b="",d=1;d<=a.length/4;d++)c=a.slice(4*d-4,4*d-2),c=a.slice(4*d-2,4*d).concat(c),b=b.concat("%u").concat(c);return b=unescape(b)}return""};window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60)}}(),window.cancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||function(a){window.clearTimeout(a)}}();var hexcase=0,b64pad="",chrsz=8;